// For format details, see https://aka.ms/devcontainer.json
{
    "name": "${localWorkspaceFolderBasename}",

    // Due to devcontainer not yet supporting the '--network host' argument when building from a Dockerfile
    // See: https://github.com/microsoft/vscode-remote-release/issues/3545
    // Workaround: build the image on the host before asking vscode to build it so that it is re-used
    "initializeCommand":
        "DOCKER_BUILDKIT=1 docker build --network host --tag poky:ubuntu-20.04 .devcontainer/",

    "build": {
        "dockerfile": "Dockerfile",
        "context": ".",
    },

    // Arguments to tuse when running the container
    "runArgs": [
        "--network=host",
        "--mount=type=volume,src=yoctovol,dst=/workspaces/${localWorkspaceFolderBasename}/yocto"
    ],

    // Environment variables to set in the container
    "containerEnv": {},

    // Volumes to mount when running the container
    "mounts": [
        "source=${localEnv:HOME}/.ssh/,target=/home/yoctouser/.ssh/,type=bind",
    ],

    // Set *default* container specific settings.json values on container create.
    "settings": {
        "terminal.integrated.profiles.linux": {
            "bash": {
                "path": "bash",
                "icon": "terminal-bash"
            },
        },
        "terminal.integrated.defaultProfile.linux": "bash",
    },

    // Add the IDs of extensions you want installed when the container is created.
    "extensions": [
        "ms-vscode.cpptools",
        "ms-vscode.cpptools-themes",
        "twxs.cmake",
        "ms-vscode.cmake-tools",
        "cschlosser.doxdocgen",
        "jeff-hykin.better-cpp-syntax",
        "ms-vscode-remote.remote-ssh",
        "coenraads.bracket-pair-colorizer-2",
        "franneck94.vscode-c-cpp-config",
        "mhutchie.git-graph",
        "github.remotehub",
        "eamodio.gitlens",
        "oderwat.indent-rainbow",
        "ms-vscode.cpptools-extension-pack"
    ],
}